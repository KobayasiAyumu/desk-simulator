<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desk Setup Simulator (Iso Ver.)</title>
    <style>
        body {
            background-color: #222; /* ã‚²ãƒ¼ãƒãƒ¼ã£ã½ãæš—ã„èƒŒæ™¯ */
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: sans-serif;
        }
        canvas {
            border: 2px solid #555;
            background-color: #333; /* åºŠã®èƒŒæ™¯è‰² */
            border-radius: 4px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            cursor: crosshair; /* åå­—ã‚«ãƒ¼ã‚½ãƒ« */
        }
        .controls {
            margin-top: 10px;
            padding: 10px;
            background: #444;
            border-radius: 8px;
        }
    </style>
</head>
<body>

    <h1>ğŸ–¥ï¸ My Desk Setup (Alpha)</h1>
    <canvas id="isoCanvas" width="800" height="600"></canvas>
    
    <div class="controls">
        <p>ã¾ã æ“ä½œã¯ã§ãã¾ã›ã‚“ã€‚ã‚³ãƒ¼ãƒ‰å†…ã®åº§æ¨™ã‚’å¤‰ãˆã‚‹ã¨æœºãŒå‹•ãã¾ã™ã€‚</p>
    </div>

    <script>
        const canvas = document.getElementById('isoCanvas');
        const ctx = canvas.getContext('2d');

        // === è¨­å®šå€¤ ===
        const GRID_SIZE = 10;       // ã‚°ãƒªãƒƒãƒ‰ã®ãƒã‚¹ç›® (10x10)
        const TILE_WIDTH = 60;      // ã‚¿ã‚¤ãƒ«1æšã®æ¨ªå¹… (ãƒ”ã‚¯ã‚»ãƒ«)
        const TILE_HEIGHT = 30;     // ã‚¿ã‚¤ãƒ«1æšã®ç¸¦å¹… (ãƒ”ã‚¯ã‚»ãƒ«)
        
        // Canvasã®ä¸­å¤®ã‚’åŸç‚¹(0,0)ã«ã™ã‚‹ãŸã‚ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼ˆãšã‚‰ã—é‡ï¼‰
        const ORIGIN_X = canvas.width / 2;
        const ORIGIN_Y = 150; // å°‘ã—ä¸Šã«é…ç½®

        // æœºã‚’ç½®ãä½ç½®ï¼ˆã‚°ãƒªãƒƒãƒ‰åº§æ¨™ï¼‰â˜…ã“ã“ã‚’å¤‰ãˆã‚‹ã¨å ´æ‰€ãŒå¤‰ã‚ã‚‹ï¼
        let deskX = 0;
        let deskY = 8;

        // ==========================================
        // ğŸ“ æ ¸å¿ƒï¼šåº§æ¨™å¤‰æ›é–¢æ•° (Iso -> Screen)
        // ==========================================
        // ã‚°ãƒªãƒƒãƒ‰ä¸Šã®åº§æ¨™(x, y, z)ã‚’å—ã‘å–ã‚Šã€
        // Canvasä¸Šã®æç”»åº§æ¨™{x, y}ã‚’è¿”ã™é­”æ³•ã®é–¢æ•°
        function toScreen(gridX, gridY, gridZ = 0) {
            const screenX = ORIGIN_X + (gridX - gridY) * (TILE_WIDTH / 2);
            const screenY = ORIGIN_Y + (gridX + gridY) * (TILE_HEIGHT / 2) - (gridZ * TILE_HEIGHT);
            return { x: screenX, y: screenY };
        }

        // ==========================================
        // ğŸ¨ æç”»é–¢æ•°ç¾¤
        // ==========================================

        // 1æšã®ã‚¿ã‚¤ãƒ«ï¼ˆåºŠï¼‰ã‚’æã
        function drawTile(gx, gy) {
            // ã‚¿ã‚¤ãƒ«ã®4éš…ã®åº§æ¨™ã‚’è¨ˆç®—
            const top = toScreen(gx, gy, 0);
            const right = toScreen(gx + 1, gy, 0);
            const bottom = toScreen(gx + 1, gy + 1, 0);
            const left = toScreen(gx, gy + 1, 0);

            ctx.beginPath();
            ctx.moveTo(top.x, top.y);
            ctx.lineTo(right.x, right.y);
            ctx.lineTo(bottom.x, bottom.y);
            ctx.lineTo(left.x, left.y);
            ctx.closePath();

            // è‰²è¨­å®šï¼ˆãƒã‚§ãƒƒã‚«ãƒ¼æŸ„ã«ã—ã¦åˆ†ã‹ã‚Šã‚„ã™ãã™ã‚‹ï¼‰
            ctx.fillStyle = (gx + gy) % 2 === 0 ? '#555' : '#444';
            ctx.fill();
            ctx.strokeStyle = '#666'; // æ ç·š
            ctx.stroke();
        }

        // ç«‹æ–¹ä½“ï¼ˆæœºãªã©ï¼‰ã‚’æã
        // width, depth: ã‚°ãƒªãƒƒãƒ‰ä½•å€‹åˆ†ã‹ / height: é«˜ã•å€ç‡
        function drawCube(gx, gy, width, depth, height, colorTop, colorSide) {
            // 3ã¤ã®é¢ï¼ˆä¸Šã€å³ä¸‹ã€å·¦ä¸‹ï¼‰ã‚’æã„ã¦ç«‹ä½“ã«è¦‹ã›ã‚‹

            // åº•é¢ã®4éš…
            const p1 = toScreen(gx, gy, 0);
            const p2 = toScreen(gx + width, gy, 0);
            const p3 = toScreen(gx + width, gy + depth, 0);
            const p4 = toScreen(gx, gy + depth, 0);

            // ä¸Šé¢ã®4éš…ï¼ˆé«˜ã•Zã‚’åŠ ãˆã‚‹ï¼‰
            const h = height;
            const t1 = toScreen(gx, gy, h);
            const t2 = toScreen(gx + width, gy, h);
            const t3 = toScreen(gx + width, gy + depth, h);
            const t4 = toScreen(gx, gy + depth, h);

            // 1. å·¦ä¸‹ã®é¢ã‚’æã
            ctx.fillStyle = colorSide; // å°‘ã—æš—ã„è‰²
            ctx.beginPath();
            ctx.moveTo(p1.x, p1.y); ctx.lineTo(p4.x, p4.y); ctx.lineTo(t4.x, t4.y); ctx.lineTo(t1.x, t1.y);
            ctx.closePath(); ctx.fill(); ctx.stroke();

            // 2. å³ä¸‹ã®é¢ã‚’æã
            ctx.fillStyle = colorSide; // å°‘ã—æš—ã„è‰²
            ctx.beginPath();
            ctx.moveTo(p4.x, p4.y); ctx.lineTo(p3.x, p3.y); ctx.lineTo(t3.x, t3.y); ctx.lineTo(t4.x, t4.y);
            ctx.closePath(); ctx.fill(); ctx.stroke();
            
            // 3. ä¸Šé¢ã‚’æãï¼ˆä¸€ç•ªæ˜ã‚‹ã„è‰²ï¼‰
            ctx.fillStyle = colorTop;
            ctx.beginPath();
            ctx.moveTo(t1.x, t1.y); ctx.lineTo(t2.x, t2.y); ctx.lineTo(t3.x, t3.y); ctx.lineTo(t4.x, t4.y);
            ctx.closePath(); ctx.fill(); ctx.stroke();
        }

        // ==========================================
        // ğŸ”„ ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆæç”»å®Ÿè¡Œï¼‰
        // ==========================================
        function drawMap() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // ç”»é¢ã‚¯ãƒªã‚¢

            // 1. ã‚°ãƒªãƒƒãƒ‰åºŠã‚’æã
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    drawTile(x, y);
                }
            }

            // 2. æœºã‚’æã
            // ã‚°ãƒªãƒƒãƒ‰(deskX, deskY)ã®ä½ç½®ã«ã€å¹…3xå¥¥è¡Œ2xé«˜ã•1.5 ã®æœºã‚’ç½®ã
            drawCube(deskX, deskY, 3, 2, 1.5, '#8e44ad', '#6c3483'); // ç´«è‰²ã®æœº
        }

        // æœ€åˆã®æç”»ã‚’å®Ÿè¡Œ
        drawMap();

    </script>
</body>
</html>